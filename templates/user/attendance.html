{% extends "user/base.html" %}
{% set active = "attendance" %}

{% block content %}
  <h1 class="page-title">Attendance History</h1>
  <p class="page-sub">Track your attendance and working hours</p>

  <div class="grid-4" style="grid-template-columns: repeat(3, minmax(0, 1fr));">
    <div class="card pad kpi">
      <div class="kpi-top"><div class="badge-icon">âœ…</div></div>
      <label>Present Days</label>
      <div class="value">{{ d.attendance_stats.present }}</div>
    </div>

    <div class="card pad kpi">
      <div class="kpi-top"><div class="badge-icon">â›”</div></div>
      <label>Absent Days</label>
      <div class="value">{{ d.attendance_stats.absent }}</div>
    </div>

    <div class="card pad kpi">
      <div class="kpi-top"><div class="badge-icon">ðŸŸ¡</div></div>
      <label>Late Arrivals</label>
      <div class="value">{{ d.attendance_stats.late }}</div>
    </div>
  </div>

  <div class="card calendar">
    <div class="calendar-head">
      <div style="font-weight:700;color:#8e6e5e;font-size:18px;">{{ d.calendar.month_label }}</div>
      <div style="opacity:.6;cursor:pointer;user-select:none;font-size:20px;">â€¹  â€º</div>
    </div>

    <div class="calendar-grid" style="margin-bottom:10px;font-size:12px;color:#8a7f76;font-weight:600;">
      <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
    </div>

    <div class="calendar-grid">
      {% for day in range(1, 32) %}
        {% set st = d.calendar.days.get(day, 'none') %}
        <div class="cal-cell {{ st }}">{{ day }}</div>
      {% endfor %}
    </div>

    <div class="legend">
      <span><i class="dot present"></i> Present</span>
      <span><i class="dot absent"></i> Absent</span>
      <span><i class="dot late"></i> Late</span>
      <span><i class="dot none"></i> No Record</span>
    </div>
  </div>

  <div class="card pad" style="margin-top:16px;">
    <div style="font-weight:800;color:#8e6e5e;margin-bottom:14px;font-size:16px;">Recent Check-ins</div>

    {% if d.recent_checkins and d.recent_checkins|length > 0 %}
      <div class="list">
        {% for r in d.recent_checkins %}
          <div class="list-item">
            <div>
              <div class="title">{{ r.date }}</div>
              <div class="time">{{ r.in }} - {{ r.out }}</div>
            </div>
            <div style="text-align:right;">
              <div style="font-weight:800;color:#6f4e3f;">{{ r.total }}</div>
              <div class="time">Total Hours</div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div style="text-align:center;padding:30px;color:#8a7f76;">
        <div style="font-size:40px;margin-bottom:10px;">ðŸ“…</div>
        <div>No check-ins recorded yet.</div>
      </div>
    {% endif %}
  </div>
{% endblock %}