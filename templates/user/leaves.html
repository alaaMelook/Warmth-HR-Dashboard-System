{% extends "user/base.html" %}
{% set active = "leaves" %}

{% block content %}
  <h1 class="page-title">Leave Management</h1>
  <p class="page-sub">Request time off and view your leave history</p>

  <div class="card pad leave-request-card">
    <div class="section-header">
      <div class="badge-icon">ğŸ—“ï¸</div>
      <h2 class="section-title">Request Leave</h2>
    </div>

    <form class="form-grid" method="POST" action="{{ url_for('user_leaves') }}">
      <div class="full-width">
        <label class="form-label">Leave Type <span class="required">*</span></label>
        <select name="leave_type" required>
          <option value="">Select leave type</option>
          <option value="vacation">Vacation Leave</option>
          <option value="sick">Sick Leave</option>
          <option value="personal">Personal Leave</option>
          <option value="unpaid">Unpaid Leave</option>
        </select>
      </div>

      <div>
        <label class="form-label">Start Date <span class="required">*</span></label>
        <input class="input" name="start_date" type="date" required />
      </div>

      <div>
        <label class="form-label">End Date <span class="required">*</span></label>
        <input class="input" name="end_date" type="date" required />
      </div>

      <div class="full-width">
        <label class="form-label">Reason (Optional)</label>
        <textarea name="reason" placeholder="Please provide a reason for your leave request..." style="min-height:80px;"></textarea>
      </div>

      <div class="full-width" style="margin-top:6px;">
        <button class="btn" type="submit">âœˆï¸ Submit Leave Request</button>
      </div>
    </form>
  </div>

  <div class="card pad leave-history-card">
    <h2 class="leave-history-header">Leave History</h2>

    {% if d.leave_history and d.leave_history|length > 0 %}
      <div class="list">
        {% for h in d.leave_history %}
          <div class="list-item">
            <div class="leave-info">
              <div class="badge-icon">
                {% if h.status|lower == 'approved' %}âœ…
                {% elif h.status|lower == 'rejected' %}âŒ
                {% else %}â³
                {% endif %}
              </div>
              <div class="leave-details">
                <div class="title">{{ h.type }}</div>
                <div class="time">{{ h.date }}</div>
              </div>
            </div>

            <div class="leave-status-section">
              <div class="pill days">{{ h.days }} days</div>

              {% set st = h.status|lower %}
              {% if st == 'approved' %}
                <div class="pill status-approved">{{ h.status }}</div>
              {% elif st == 'rejected' %}
                <div class="pill status-rejected">{{ h.status }}</div>
              {% else %}
                <div class="pill status-pending">{{ h.status }}</div>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="leave-empty-state">
        <div class="leave-empty-icon">ğŸ“</div>
        <div class="leave-empty-text">No leave requests yet.</div>
      </div>
    {% endif %}
  </div>
{% endblock %}