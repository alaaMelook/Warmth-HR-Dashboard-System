<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - Admin Panel</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/user.css') }}">
    <style>
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .setting-section {
            background: var(--card);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            border: 1px solid var(--line);
            padding: 20px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--line);
        }
        
        .section-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: #f2eee9;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: 700;
            color: #6f4e3f;
        }
        
        .setting-item {
            margin-bottom: 16px;
        }
        
        .setting-item:last-child {
            margin-bottom: 0;
        }
        
        .setting-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #6e625a;
            margin-bottom: 6px;
        }
        
        .setting-desc {
            display: block;
            font-size: 12px;
            color: var(--muted);
            margin-top: 4px;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 26px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ddd;
            transition: .3s;
            border-radius: 26px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background: linear-gradient(90deg, var(--brown1), var(--brown2));
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(22px);
        }
        
        .setting-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0e8e0;
        }
        
        .setting-row:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .user-stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 14px;
            background: #f8f2ec;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .user-stat:last-child {
            margin-bottom: 0;
        }
        
        .user-stat-label {
            font-size: 13px;
            color: #6e625a;
            font-weight: 600;
        }
        
        .user-stat-value {
            font-size: 14px;
            font-weight: 700;
            color: var(--brown1);
            background: white;
            padding: 4px 10px;
            border-radius: 6px;
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
        
        @media (max-width: 1100px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="brand">
                <span>üë• HR System</span>
            </div>

            <nav class="nav">
                <a href="{{ url_for('admin_dashboard') }}">
                    <span class="icon">üìä</span>
                    Dashboard
                </a>
                <a href="{{ url_for('admin_employees') }}">
                    <span class="icon">üë•</span>
                    Employees
                </a>
                <a href="{{ url_for('admin_attendance') }}">
                    <span class="icon">üìÖ</span>
                    Attendance
                </a>
                <a href="{{ url_for('admin_leaves') }}">
                    <span class="icon">üìÑ</span>
                    Leaves
                </a>
                <a href="{{ url_for('admin_payroll') }}">
                    <span class="icon">üí∞</span>
                    Payroll
                </a>
                <a href="{{ url_for('admin_settings') }}" class="active">
                    <span class="icon">‚öôÔ∏è</span>
                    Settings
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="avatar">AD</div>
                <div style="flex:1; min-width:0;">
                    <div style="font-weight:600; font-size:14px; color:#6e625a;">{{ session.user_name }}</div>
                    <div style="font-size:11px; color:#9b8f86;">Administrator</div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main">
            <div class="header-hero">
                <h1>Settings</h1>
                <p>Configure your system settings and preferences.</p>
            </div>

            <!-- Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, msg in messages %}
                        <div class="alert-{{ category }}" style="margin-bottom:20px;">
                            {{ msg }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <div class="settings-grid">
                <!-- Company Information -->
                <div class="setting-section">
                    <div class="section-header">
                        <div class="section-icon">üè¢</div>
                        <div class="section-title">Company Information</div>
                    </div>
                    
                    <form method="POST" action="{{ url_for('admin_update_company_info') }}">
                        <div class="setting-item">
                            <label class="setting-label">Company Name</label>
                            <input type="text" name="company_name" class="input" value="{{ company_info.name if company_info else 'TechCorp Inc.' }}" placeholder="Enter company name">
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">Industry</label>
                            <input type="text" name="industry" class="input" value="{{ company_info.industry if company_info else 'Technology' }}" placeholder="e.g., Technology, Healthcare">
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">Employee Count</label>
                            <input type="number" name="employee_count" class="input" value="{{ company_info.employee_count if company_info else '248' }}" placeholder="Number of employees">
                        </div>

                        <button type="submit" class="btn" style="margin-top: 12px;">
                            üíæ Save Changes
                        </button>
                    </form>
                </div>

                <!-- User Management -->
                <div class="setting-section">
                    <div class="section-header">
                        <div class="section-icon">üë•</div>
                        <div class="section-title">User Management</div>
                    </div>

                    <div class="user-stat">
                        <span class="user-stat-label">Admin Users</span>
                        <span class="user-stat-value">{{ admin_count if admin_count else 5 }}</span>
                    </div>

                    <div class="user-stat">
                        <span class="user-stat-label">HR Managers</span>
                        <span class="user-stat-value">{{ manager_count if manager_count else 12 }}</span>
                    </div>

                    <div class="user-stat">
                        <span class="user-stat-label">Employees</span>
                        <span class="user-stat-value">{{ employee_count if employee_count else 231 }}</span>
                    </div>

                    <a href="#" onclick="alert('Roles management - Coming soon!'); return false;" class="btn-sm" style="width:100%; margin-top:16px; justify-content:center; display:flex;">
                        üîë Manage Roles & Permissions
                    </a>
                </div>

                <!-- Notifications -->
                <div class="setting-section">
                    <div class="section-header">
                        <div class="section-icon">üîî</div>
                        <div class="section-title">Notifications</div>
                    </div>

                    <form method="POST" action="{{ url_for('admin_update_notifications') }}">
                        <div class="setting-row">
                            <div>
                                <span class="setting-label">Email Notifications</span>
                                <span class="setting-desc">Receive updates via email</span>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" name="email_notifications" {% if settings.email_notifications %}checked{% endif %}>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row">
                            <div>
                                <span class="setting-label">Leave Request Alerts</span>
                                <span class="setting-desc">Notify on new requests</span>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" name="leave_alerts" {% if settings.leave_alerts %}checked{% endif %}>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row">
                            <div>
                                <span class="setting-label">Attendance Reminders</span>
                                <span class="setting-desc">Daily clock-in reminders</span>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" name="attendance_reminders" {% if settings.attendance_reminders %}checked{% endif %}>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <button type="submit" class="btn" style="margin-top: 16px;">
                            üíæ Save Preferences
                        </button>
                    </form>
                </div>

                <!-- Security & Privacy -->
                <div class="setting-section">
                    <div class="section-header">
                        <div class="section-icon">üîí</div>
                        <div class="section-title">Security & Privacy</div>
                    </div>

                    <div class="setting-item">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                            <div>
                                <span class="setting-label">üîê Two-Factor Authentication</span>
                                <span class="setting-desc">Add an extra layer of security</span>
                            </div>
                        </div>
                        <button onclick="enable2FA()" class="btn-sm primary" style="width:100%; justify-content:center;">
                            Enable 2FA
                        </button>
                    </div>

                    <div class="setting-item" style="margin-top:20px;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                            <div>
                                <span class="setting-label">üö® Login Alerts</span>
                                <span class="setting-desc">Get notified of suspicious logins</span>
                            </div>
                        </div>
                        <button onclick="configureAlerts()" class="btn-sm" style="width:100%; justify-content:center;">
                            Configure
                        </button>
                    </div>
                </div>

                <!-- System Preferences (Full Width) -->
                <div class="setting-section full-width">
                    <div class="section-header">
                        <div class="section-icon">‚öôÔ∏è</div>
                        <div class="section-title">System Preferences</div>
                    </div>

                    <form method="POST" action="{{ url_for('admin_update_system_prefs') }}">
                        <div class="form-grid">
                            <div>
                                <label class="setting-label">Time Zone</label>
                                <select name="timezone" class="input">
                                    <option value="UTC-5">UTC-5 (EST)</option>
                                    <option value="UTC-6">UTC-6 (CST)</option>
                                    <option value="UTC-7">UTC-7 (MST)</option>
                                    <option value="UTC-8">UTC-8 (PST)</option>
                                    <option value="UTC+0">UTC+0 (GMT)</option>
                                    <option value="UTC+2">UTC+2 (EET)</option>
                                </select>
                            </div>

                            <div>
                                <label class="setting-label">Date Format</label>
                                <select name="date_format" class="input">
                                    <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                    <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                    <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                                </select>
                            </div>

                            <div>
                                <label class="setting-label">Language</label>
                                <select name="language" class="input">
                                    <option value="en">English</option>
                                    <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                                    <option value="es">Espa√±ol</option>
                                    <option value="fr">Fran√ßais</option>
                                </select>
                            </div>

                            <div>
                                <label class="setting-label">Currency</label>
                                <select name="currency" class="input">
                                    <option value="USD">USD ($)</option>
                                    <option value="EGP">EGP (¬£)</option>
                                    <option value="EUR">EUR (‚Ç¨)</option>
                                    <option value="GBP">GBP (¬£)</option>
                                </select>
                            </div>
                        </div>

                        <button type="submit" class="btn" style="margin-top: 20px;">
                            üíæ Save Preferences
                        </button>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <script>
        function enable2FA() {
            alert('2FA setup will be implemented. This would typically open a modal with QR code.');
        }

        function configureAlerts() {
            alert('Login alerts configuration will be implemented.');
        }

        // Auto-submit toggle changes
        document.querySelectorAll('.toggle-switch input').forEach(toggle => {
            toggle.addEventListener('change', function() {
                // You can add auto-save functionality here if needed
                console.log('Toggle changed:', this.name, this.checked);
            });
        });
    </script>
</body>
</html>