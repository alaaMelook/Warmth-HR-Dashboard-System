<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Employee - Admin Panel</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/user.css') }}">
</head>
<body>
    <div class="layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="brand">
                <span>ðŸ‘¥ HR System</span>
            </div>

            <nav class="nav">
                <a href="{{ url_for('admin_dashboard') }}">
                    <span class="icon">ðŸ“Š</span>
                    Dashboard
                </a>
                <a href="{{ url_for('admin_employees') }}" class="active">
                    <span class="icon">ðŸ‘¥</span>
                    Employees
                </a>                <a href="{{ url_for('admin_user_import') }}">
                    <span class="icon">ðŸ“¥</span>
                    User Import
                </a>                <a href="{{ url_for('admin_attendance') }}">
                    <span class="icon">ðŸ“…</span>
                    Attendance
                </a>
                <a href="{{ url_for('admin_leaves') }}">
                    <span class="icon">ðŸ“„</span>
                    Leaves
                </a>
                <a href="{{ url_for('admin_payroll') }}">
                    <span class="icon">ðŸ’°</span>
                    Payroll
                </a>
                <a href="{{ url_for('admin_announcements') }}">
                    <span class="icon">ðŸ“¢</span>
                    Announcements
                </a>
                <a href="{{ url_for('logout') }}">
                    <span class="icon">ðŸšª</span>
                    Logout
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="avatar">AD</div>
                <div style="flex:1; min-width:0;">
                    <div style="font-weight:600; font-size:14px; color:#6e625a;">{{ session.user_name }}</div>
                    <div style="font-size:11px; color:#9b8f86;">Administrator</div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main">
            <div class="header-hero">
                <h1>Edit Employee</h1>
                <p>Update employee information in the system.</p>
            </div>

            <div class="card pad" style="max-width:900px;">
                <!-- Flash Messages -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, msg in messages %}
                            <div class="alert-{{ category }}" style="margin-bottom:20px;">
                                {{ msg }}
                            </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}

                <form method="POST" action="{{ url_for('admin_edit_employee', employee_id=employee.employee_id) }}">
                    <div class="form-grid">
                        <div>
                            <label style="display:block; font-size:13px; font-weight:600; color:#6e625a; margin-bottom:6px;">First Name *</label>
                            <input type="text" name="first_name" class="input" value="{{ employee.first_name }}" required>
                        </div>

                        <div>
                            <label style="display:block; font-size:13px; font-weight:600; color:#6e625a; margin-bottom:6px;">Last Name *</label>
                            <input type="text" name="last_name" class="input" value="{{ employee.last_name }}" required>
                        </div>

                        <div>
                            <label style="display:block; font-size:13px; font-weight:600; color:#6e625a; margin-bottom:6px;">Email *</label>
                            <input type="email" name="email" class="input" value="{{ employee.email }}" required>
                        </div>

                        <div>
                            <label style="display:block; font-size:13px; font-weight:600; color:#6e625a; margin-bottom:6px;">Phone</label>
                            <input type="tel" name="phone" class="input" value="{{ employee.phone if employee.phone else '' }}">
                        </div>

                        <div>
                            <label style="display:block; font-size:13px; font-weight:600; color:#6e625a; margin-bottom:6px;">Role *</label>
                            <select name="role_id" class="input" required>
                                <option value="">Select Role</option>
                                <option value="1" {% if employee.role_id == 1 %}selected{% endif %}>Employee</option>
                                <option value="2" {% if employee.role_id == 2 %}selected{% endif %}>Admin</option>
                            </select>
                        </div>

                        <div>
                            <label style="display:block; font-size:13px; font-weight:600; color:#6e625a; margin-bottom:6px;">Department</label>
                            <select name="department_id" class="input">
                                <option value="">Select Department</option>
                                {% for dept in departments %}
                                    <option value="{{ dept.department_id }}" {% if employee.department_id == dept.department_id %}selected{% endif %}>{{ dept.department_name }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div>
                            <label style="display:block; font-size:13px; font-weight:600; color:#6e625a; margin-bottom:6px;">Job Title</label>
                            <select name="job_title_id" class="input">
                                <option value="">Select Job Title</option>
                                {% for job in job_titles %}
                                    <option value="{{ job.job_title_id }}" {% if employee.job_title_id == job.job_title_id %}selected{% endif %}>{{ job.title_name }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div>
                            <label style="display:block; font-size:13px; font-weight:600; color:#6e625a; margin-bottom:6px;">Hire Date</label>
                            <input type="date" name="hire_date" class="input" value="{{ employee.hire_date if employee.hire_date else '' }}">
                        </div>

                        <div>
                            <label style="display:block; font-size:13px; font-weight:600; color:#6e625a; margin-bottom:6px;">Status *</label>
                            <select name="status" class="input" required>
                                <option value="active" {% if employee.status == 'active' %}selected{% endif %}>Active</option>
                                <option value="inactive" {% if employee.status == 'inactive' %}selected{% endif %}>Inactive</option>
                            </select>
                        </div>
                    </div>

                    <div style="display:flex; gap:12px; margin-top:24px;">
                        <button type="submit" class="btn">âœ“ Update Employee</button>
                        <a href="{{ url_for('admin_employees') }}" class="btn" style="background:#e7d6c9; color:#8e6e5e;">âœ— Cancel</a>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <script>
        // Auto-hide flash messages after 3 seconds
        document.addEventListener('DOMContentLoaded', function() {
            const alerts = document.querySelectorAll('.alert');
            alerts.forEach(function(alert) {
                setTimeout(function() {
                    alert.style.transition = 'opacity 0.5s ease';
                    alert.style.opacity = '0';
                    setTimeout(function() {
                        alert.remove();
                    }, 500);
                }, 3000);
            });
        });
    </script>
</body>
</html>